https://github.com/hujieying/Python-data-analysis/tree/master/data-analysis-learning-summary

# 常见EXCEL函数
## 数据清理类  
|序号|函数名|作用|用法示例|对应MySql|对应Python|其他说明|
|-------|:--------|:--------|:--------|:--------|:--------|--------|
|1|Trim|清理掉字符串两边的空格||有同名函数|有近似函数strip||
|2|Concatenate|合并单元格|=Concatenate(单元格1，单元格2……)|有近似函数concat|||
|3|Replace|替换掉单元格的字符串，清洗使用较多|=Replace（指定字符串，哪个位置开始替换，替换几个字符，替换成什么）|有同名函数|有同名函数||
|4|Substitute|和replace接近，区别是替换为全局替换，没有起始位置的概念|||||
|5|Left／Right／Mid|截取字符串中的字符。Left/Right（指定字符串，截取长度）。left为从左，right为从右|=Mid(指定字符串，开始位置，截取长度)|有同名函数|||
|6|Len／Lenb|返回字符串的长度，在len中，中文计算为一个，在lenb中，中文计算为两个||有同名函数|有同名函数||
|7|Find|查找某字符串出现的位置，可以指定为第几次出现，与Left／Right／Mid结合能完成简单的文本提取|=Find（要查找字符，指定字符串，第几个字符）|有近似函数 find_in_set|有同名函数||
|8|Search|和Find类似，区别是Search大小写不敏感，但支持＊通配符|||||
|9|Text|将数值转化为指定的文本格式，可以和时间序列函数一起看||||||

## 关联匹配类  
|序号|函数名|作用|用法示例|对应MySql|对应Python|其他说明|
|-------|:--------|:--------|:--------|:--------|:--------|--------|
|1|Lookup|最被忽略的函数，功能性和Vlookup一样，但是引申有数组匹配和二分法。|=Lookup（查找的值，值所在的位置，返回相应位置的值）||||
|2|Vlookup|Excel第一大难关，因为涉及的逻辑对新手较复杂，通俗的理解是查找到某个值然后黏贴过来|=Vlookup(查找的值，哪里找，找哪个位置的值，是否精准匹配)||||
|3|Index|和Match组合，媲美Vlookup，但是功能更强大|=Index（查找的区域，区域的第几行，区域的第几列）||||
|4|Match|和Lookup类似，可以按照指定方式查找，比如小于大于等于，返回值所在的位置|=Match（查找指定的值，查找所在区域，查找方式的参数）||||
|5|Row|返回单元格所在的行|||||
|6|Column|返回单元格所在的列|||||
|7|Offset|建立坐标系，以坐标系为原点，返回距离原点的值或区域。正数代表向下或向左，负数则相反。|=Offset（指定点，偏移多少行，偏移多少列，返回多少行，返回多少列）|||||

## 逻辑运算类  
|序号|函数名|作用|用法示例|对应MySql|对应Python|其他说明|
|-------|:--------|:--------|:--------|:--------|:--------|--------|
|1|IF|经典的如果但是，在后期的Python中，也会经常用到，当然会有许多更优雅的写法。也有ifs用法，取代if(and())的写法。||有同名函数|有同名函数||
|2|AND|全部参数为True，则返回True，经常用于多条件判断||有同名函数|有同名函数||
|3|OR|只要参数有一个True，则返回Ture，经常用于多条件判断。||有同名函数|有同名函数||
|4|IS系列|常用判断检验，返回的都是布尔数值True和False。常用ISERR，ISERROR，ISNA，ISTEXT，可以和IF嵌套使用。||有同名函数|有同名函数|||

## 计算统计类  
|序号|函数名|作用|用法示例|对应MySql|对应Python|其他说明|
|-------|:--------|:--------|:--------|:--------|:--------|--------|
|1|Sum／Sumif／Sumifs|统计满足条件的单元格总和，SQL有中同名函数。||有同名函数|有同名函数||
|2|Sumproduct|统计总和相关，如果有两列数据销量和单价，现在要求卖出增加，用sumproduct是最方便的。||有同名函数|||
|3|Count／Countif／Countifs|统计满足条件的字符串个数||有同名函数|有同名函数||
|4|Max|返回数组或引用区域的最大值||同名函数|同名函数||
|5|Min|返回数组或引用区域的最小值||有同名函数|有同名函数||
|6|Rank|排序，返回指定值在引用区域的排名，重复值同一排名。||有近似函数row_number() |||
|7|Rand／Randbetween|常用随机抽样，前者返回0~1之间的随机值，后者可以指定范围。||有同名函数|||
|8|Averagea|求平均值，也有Averageaif，Averageaifs||有同名函数|有近似函数mean||
|9|Quartile|计算四分位数，比如1~100的数字中，25分位就是按从小到大排列，在25%位置的数字，即25。参数0代表最小值，参数4代表最大值，1~3对应25、50（中位数）、75分位|=Quartile（指定区域，分位参数）||||
|10|Stdev|求标准差，统计型函数，|||||
|11|Substotal|汇总型函数，将平均值、计数、最大最小、相乘、标准差、求和、方差等参数化，换言之，只要会了这个函数，上面的都可以抛弃掉了|=Substotal（引用区域，参数）||||
|12|Int／Round|取整函数，int向下取整，round按小数位取数。|round(3.1415,2) =3.14 ; round(3.1415,1)=3.1|||||

## 时间序列类  
专门用于处理时间格式以及转换，时间序列在金融、财务等数据分析中占有较大比重。时机序列的处理函数比我列举了还要复杂，比如时区、分片、复杂计算等。这里只做一个简单概述  

|序号|函数名|作用|用法示例|对应MySql|对应Python|其他说明|
|-------|:--------|:--------|:--------|:--------|:--------|--------|
|1|Year/Month|返回日期中的年/月||有同名函数|||
|2|Weekday|返回指定时间为一周中的第几天，参数为1代表从星期日开始算作第一天，参数为2代表从星期一开始算作第一天（中西方差异）。我们中国用2为参数即可。|=Weekday(指定时间，参数)|有同名函数|||
|3|Weeknum|返回一年中的第几个星期，后面的参数类同weekday，意思是从周日算还是周一。|=Weeknum(指定时间，参数)|有近似函数 week|||
|4|Day|返回日期中的日（第几号）||有同名函数|||
|5|Date|时间转换函数，等于将year()，month()，day()合并|=Date（年，月，日）|有近似函数 date_format|||
|6|Today|返回今天的日期，动态函数||有同名函数|||
|7|Datedif|日期计算函数，计算两日期的差。参数决定返回的是年还是月等。|=Datedif（开始日期，结束日期，参数）|近似函数 DateDiff||||

学习参考资料：
[数据分析：常见的Excel函数全部涵盖在这里了](https://mp.weixin.qq.com/s?__biz=MjM5NjEyMDI2MQ==&mid=2455946747&idx=1&sn=667693f99cc34ca357719cc459fba183&chksm=b1787651860fff47f24645579fe956e952360ddc597b1fd5be43f90df2212103434dc42731a5&scene=21#wechat_redirect)

# EXCEL技巧
## 快捷键
Excel的快捷键很多，以下主要是能提高效率：
Crtl+方向键，对单元格光标快速移动，移动到数据边缘（空格位置）。
Crtl+Shift+方向键，对单元格快读框选，选择到数据边缘（空格位置）。
Ctrrl+空格键，选定整列。
Shift+空格键，选定整行。
Ctrl+A，选择整张表内容。
Alt+Enter，换行。
Ctrl+Enter，以当前单元格为始，往下填充数据和函数。
Ctrl+S，快读保存，你懂的。
Ctrl+Z，撤回当前操作。
如果是效率达人，可以学习更多快捷键。Mac用户的ctrl一般需要用command替换。

## 格式转换
* 通常我们将Excel格式分为数值、文本、时间。
* 数值常见整数型 Int和小数/浮点型 Float。两者的界限很模糊。在SQL和Python中，则会牵扯的复杂，涉及运算效率，计算精度等。
* 文本分为中文和英文，存储字节，字符长度不同。中文很容易遇到编码问题，尤其是Python2。Win和Mac环境也有差异。大家遇到的乱码一般都属于中文编码错误。
* 时间格式在Excel中可以和数值直接互换，也能用加减法进行天数换算。

## 数组
* 数组很多人都不会用到，甚至不知道有这个功能。依旧是数据分析越往后用到越多，它类似R语言的Array和Python的List。
* 数组由多个元素组成。普通函数的计算结果是一个值，数组类函数的计算结果返回多个值。
* 数组用大括号表示，当函数中使用到数组，应该用Ctrl+Shift+Enter输入，不然会报错。
* 数组的最基础使用。选择A1:D1区域，输入={1,2,3,4}。记住是大括号。然后Ctrl+Shift+Enter。我们发现数组里的四个值被分别传到四个单元格中，这是数组的独有用法。
* 数组和函数的应用。利用{}，我们能做到1匹配a，2匹配b，3匹配c。也就是一一对应。专业说法是Mapping。
> =lookup(查找值,{1,2,3},{"a","b","c"})

## 分列
* 常常用来进行数据清洗
* SQL和Python中有类似的spilt ( )函数。

## 数据透视表
* 数据透视表的主要功能是将数据聚合，按照各子段进行sum( )，count( )的运算。
* 聚合功能有一点类似SQL中的gorup by，python中则有更为强大的pandas.pivot_table( )。

## 删除重复项
* 一种数据清洗和检验的快速方式。想要验证某一列有多少个唯一值，或者数据清洗，都可以使用。
* 功能类似SQL中的distinct ,python中的set

## 条件格式
* 条件格式可以当作数据可视化的应用。如果我们要使用函数在大量数据中找出前三的值，可能会用到rank( )函数，排序，然后过滤出1，2，3。
* 用条件格式则是另外一种快速方法，直接用颜色标出，非常直观。

## 冻结首行首列
* Excel的首行一般是各字段名Header，俗称表头，当行数和列数过多的时候，观察数据比较麻烦。我们可以通过固定住首行，方便浏览和操作。
* Header是一个较为重要的概念。在Python和R中，read_csv函数，会有一个专门的参数header=true，来判断是否读取表头作为columns的名字。

## 数据有效性
* 数据有效性是一种约束，针对单元格限制其输入，也就是让其只能固定几个值。下拉菜单是一种高阶应用，通过允许下拉箭头即可

## 自定义名称
* 可以为一个区域，变量、或者数组定义一个名称。后续要经常使用的话，直接引用即可，无需再次定位。这是复用的概念。

## 分组和分级显示
* 常用在报表中，在报表行数多到一定程度时，通过分组达到快速切换和隐藏的目的。越是专业度的报表（咨询、财务等），越可以学习这块

## 分析工具库
* 分析工具库是高阶分析的利器，包含很多统计计算，检验功能等工具。Excel是默认不安装的，要安装需要加载项，在工具菜单下

## 第三方应用
* Excel是支持第三方插件的，第三方插件拥有非常强大的功能。甚至完成BI的工作。
* 第三方应用是可以深学的，如果是传统行业的数据分析师，需要专注学习，互联网分析就不需要了

学习参考资料：
[数据分析：Excel技巧大揭秘](https://mp.weixin.qq.com/s?__biz=MjM5NjEyMDI2MQ==&mid=2455946754&idx=1&sn=1b906dde38b58d06be310870792000d7&chksm=b17875a8860ffcbef473aa561c64f191ddd5240893bd671491354cc12733dcff6a065c942992&scene=21#wechat_redirect)

# EXCEL实战
通常数据分析的简化流程：明确目的，观察数据，清洗数据，分析数据，得出结论。
## 明确目的
一切数据分析都是以业务为核心目的的。  
数据用来解决什么问题？  
是进行汇总统计制作成报表？  
是进行数据可视化，作为一张信息图？  
是验证某一类业务假设？  
是希望提高某一个指标的KPI？  
永远不要妄图在一堆数据中找出自己的结论，太难。目标在前，数据在后。哪怕给自己设立一个很简单的目标，例如计算业务的平均值，也比没有方向好。因为有了平均值可以想数字比预期是高了还是低了，原因在哪里，数据靠谱吗？为了找出原因还需要哪些数据。  

## 观察数据
## 清洗数据
## 分析数据
## 得出结论。

## CHANGELOG
20171230 创建
